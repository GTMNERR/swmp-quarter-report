---
title: '2021-09: SWMP Update for OWQTF'
author: "Prepared by Shannon Dunnigan and Katie Petrinec"
date: "9/29/2021"
output: 
  html_document:
    keep_md: true
    toc: true
    toc_float: true
knit: (function(inputFile, encoding) {
  rmarkdown::render(inputFile, 
                    encoding = encoding, 
                    output_dir = here::here('output', 'reports')) })
editor_options: 
  chunk_output_type: console
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(warning = FALSE)
knitr::opts_chunk$set(message = FALSE)
knitr::opts_chunk$set(dpi = 120)
source(here::here('R', '00_loadpackages.R'))
```

```{r map, include = FALSE, eval = FALSE}
# I want to make an interactive reserve map here with leaflet
# here's a resource I want to use https://towardsdatascience.com/making-interactive-maps-in-r-with-less-than-15-lines-of-code-bfd81f587e12
# picking different map styles: https://leaflet-extras.github.io/leaflet-providers/preview/
```

```{r load-data-01, include = FALSE}
# load(here::here('output', 'data', 'NUT.RData'))

source(here::here('R', 'working', '2021-09-28_OWQTF_code.R'))
```

# Chlorophyll a (ug/L)

## Historic Data with Current Year Overlay {.tabset .tabset-pills}

### Pine Island

```{r pi-chla-boxplot, echo = FALSE}
ggplotly(boxplot_currentyear(station = "gtmpinut", 
                             param = 0, 
                             threshold = 6.6) +
labs(title = "Pine Island") +
annotate("text",
           x = "Mar",
           y = 16,
           size = 3,
           color = "blue",
           label = "State Threshold 6.6 (\U00B5g/L)")
)
```

### San Sebastian

```{r ss-chla-boxplot, echo = FALSE}
ggplotly(boxplot_currentyear(station = "gtmssnut", 
                             param = 0, 
                             threshold = 4.0) +
labs(title = "San Sebastian") +
  annotate("text",
           x = "Mar",
           y = 16,
           size = 3,
           color = "blue",
           label = "State Threshold 4.0 (\U00B5g/L)")
)
```

### Fort Matanzas

```{r fm-chla-boxplot, echo = FALSE}
ggplotly(boxplot_currentyear(station = "gtmfmnut", 
                             param = 0, 
                             threshold = 5.5) +
labs(title = "Fort Matanzas") +
  annotate("text",
           x = "Mar",
           y = 24,
           size = 3,
           color = "blue",
           label = "State Threshold 5.5 (\U00B5g/L)")
)
```

### Pellicer Creek

```{r pc-chla-boxplot, echo = FALSE}
ggplotly(boxplot_currentyear(station = "gtmpcnut", 
                             param = 0, 
                             threshold = 4.3) +
labs(title = "Pellicer Creek") +
  annotate("text",
           x = "Mar",
           y = 38,
           size = 3,
           color = "blue",
           label = "State Threshold 4.3 (\U00B5g/L)")
)
```


## Annual Geometric Means 2002-2021

### Pine Island

```{r pi-chla-agm, echo = FALSE}
ggplotly(agm(station = "gtmpinut", 
                             param = 0, 
                             threshold = 6.6) +
labs(title = "Pine Island") +
annotate("text",
           x = "2006",
           y = 8,
           size = 3,
           color = "blue",
           label = "State Threshold 6.6 (\U00B5g/L)")
)
```

### San Sebastian

```{r ss-chla-agm, echo = FALSE}
ggplotly(agm(station = "gtmssnut", 
                             param = 0, 
                             threshold = 4.0) +
labs(title = "San Sebastian") +
annotate("text",
           x = "2006",
           y = 6,
           size = 3,
           color = "blue",
           label = "State Threshold 4.0 (\U00B5g/L)")
)
```

### Fort Matanzas

```{r fm-chla-agm, echo = FALSE}
ggplotly(agm(station = "gtmfmnut", 
                             param = 0, 
                             threshold = 5.5) +
labs(title = "Fort Matanzas") +
annotate("text",
           x = "2006",
           y = 6,
           size = 3,
           color = "blue",
           label = "State Threshold 5.5 (\U00B5g/L)")
)
```

### Pellicer Creek

```{r pc-chla-agm, echo = FALSE}
ggplotly(agm(station = "gtmpcnut", 
                             param = 0, 
                             threshold = 4.3) +
labs(title = "Pellicer Creek") +
annotate("text",
           x = "2006",
           y = 16,
           size = 3,
           color = "blue",
           label = "State Threshold 4.3 (\U00B5g/L)")
)
```


# Total Nitrogen (mg/L)

## Historic Data with Current Year Overlay {.tabset .tabset-pills}

### Pine Island

```{r pi-TN-boxplot, echo = FALSE}
ggplotly(boxplot_currentyear(station = "gtmpinut", 
                             param = 1, 
                             threshold = 0.65) +
labs(title = "Pine Island") +
annotate("text",
           x = "Mar",
           y = 1.2,
           size = 3,
           color = "blue",
           label = "State Threshold 0.65 (mg/L)")
)
```

### San Sebastian

```{r ss-TN-boxplot, echo = FALSE}
ggplotly(boxplot_currentyear(station = "gtmssnut", 
                             param = 1, 
                             threshold = 0.55) +
  labs(title = "San Sebastian") +
  annotate("text",
           x = "Mar",
           y = 1.0,
           size = 3,
           color = "blue",
           label = "State Threshold 0.55 (mg/L)")
)
```

### Fort Matanzas

```{r fm-TN-boxplot, echo = FALSE}
ggplotly(boxplot_currentyear(station = "gtmfmnut", 
                             param = 1, 
                             threshold = 0.55) +
  labs(title = "Fort Matanzas") +
  annotate("text",
           x = "Mar",
           y = 1.0,
           size = 3,
           color = "blue",
           label = "State Threshold 0.55 (mg/L)")
)
```

### Pellicer Creek

```{r pc-TN-boxplot, echo = FALSE}
ggplotly(boxplot_currentyear(station = "gtmpcnut", 
                             param = 1, 
                             threshold = 1.10) +
labs(title = "Pellicer Creek") +
  annotate("text",
           x = "Mar",
           y = 1.7,
           size = 3,
           color = "blue",
           label = "State Threshold 1.10 (mg/L)")
)
```


## Annual Geometric Means 2002-2021

### Pine Island

```{r pi-TN-agm, echo = FALSE}
ggplotly(agm(station = "gtmpinut", 
                             param = 1, 
                             threshold = 0.65) +
labs(title = "Pine Island") +
annotate("text",
           x = "2006",
           y = 0.68,
           size = 3,
           color = "blue",
           label = "State Threshold 0.65 (\U00B5g/L)")
)
```

### San Sebastian

```{r ss-TN-agm, echo = FALSE}
ggplotly(agm(station = "gtmssnut", 
                             param = 1, 
                             threshold = 0.55) +
labs(title = "San Sebastian") +
annotate("text",
           x = "2006",
           y = 0.58,
           size = 3,
           color = "blue",
           label = "State Threshold 0.55 (\U00B5g/L)")
)
```

### Fort Matanzas

```{r fm-TN-agm, echo = FALSE}
ggplotly(agm(station = "gtmfmnut", 
                             param = 1, 
                             threshold = 0.53) +
labs(title = "Fort Matanzas") +
annotate("text",
           x = "2006",
           y = 0.55,
           size = 3,
           color = "blue",
           label = "State Threshold 0.53 (\U00B5g/L)")
)
```

### Pellicer Creek

```{r pc-TN-agm, echo = FALSE}
ggplotly(agm(station = "gtmpcnut", 
                             param = 1, 
                             threshold = 1.10) +
labs(title = "Pellicer Creek") +
annotate("text",
           x = "2006",
           y = 1.15,
           size = 3,
           color = "blue",
           label = "State Threshold 1.1 (\U00B5g/L)")
)
```

# Total Phosphorus (mg/L)

## Historic Data with Current Year Overlay {.tabset .tabset-pills}

### Pine Island

```{r pi-TP-boxplot, echo = FALSE}
ggplotly(boxplot_currentyear(station = "gtmpinut", 
                             param = 2, 
                             threshold = 0.105) +
 labs(title = "Pine Island") +
  annotate("text",
           x = "Mar",
           y = 0.15,
           size = 3,
           color = "blue",
           label = "State Threshold 0.105 (mg/L)")
)
```

### San Sebastian

```{r ss-TP-boxplot, echo = FALSE}
ggplotly(boxplot_currentyear(station = "gtmssnut", 
                             param = 2, 
                             threshold = 0.11) +
  labs(title = "San Sebastian") +
  annotate("text",
           x = "Mar",
           y = 0.12,
           size = 3,
           color = "blue",
           label = "State Threshold 0.11 (mg/L)")
)
```

### Fort Matanzas

```{r fm-TP-boxplot, echo = FALSE}
ggplotly(boxplot_currentyear(station = "gtmfmnut", 
                             param = 2, 
                             threshold = 0.111) +
labs(title = "Fort Matanzas") +
  annotate("text",
           x = "Mar",
           y = 0.12,
           size = 3,
           color = "blue",
           label = "State Threshold 0.111 (mg/L)")
)
```

### Pellicer Creek

```{r pc-TP-boxplot, echo = FALSE}
ggplotly(boxplot_currentyear(station = "gtmpcnut", 
                             param = 2, 
                             threshold = 0.123) +
labs(title = "Pellicer Creek") +
  annotate("text",
           x = "Mar",
           y = 0.25,
           size = 3,
           color = "blue",
           label = "State Threshold 0.123 (mg/L)")
)
```


## Annual Geometric Means 2002-2021
