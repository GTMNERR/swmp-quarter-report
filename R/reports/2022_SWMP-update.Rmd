---
title: '2022 SWMP Updates'
author: "Prepared by Shannon Dunnigan and Katie Petrinec"
date: "2022-04-08 updated (`r Sys.Date()`)"
output: 
  html_document:
    keep_md: true
    toc: true
    toc_float: true
knit: (function(inputFile, encoding) {
  rmarkdown::render(inputFile, 
                    encoding = encoding, 
                    output_dir = here::here('output', 'reports')) })
editor_options: 
  chunk_output_type: console
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(warning = FALSE)
knitr::opts_chunk$set(message = FALSE)
knitr::opts_chunk$set(dpi = 120)
source(here::here('R', '00_loadpackages.R'))
```

```{r load-data-01, include = FALSE}
source(here::here('R', '02.1_load_wrangle_NUT.R'))
# load(here::here('output', 'data', 'WQ.RData'))
# load(here::here('output', 'data', 'MET.RData'))
# load(here::here('output', 'data', 'pi_wq.RData'))
# load(here::here('output', 'data', 'ss_wq.RData'))
# load(here::here('output', 'data', 'fm_wq.RData'))
# load(here::here('output', 'data', 'pc_wq.RData'))

# load graphing functions
source(here::here('R', '03_graph_fxns.R'))

# run source code below if data has not been updated in the saved RData files

source(here::here('R', '02.2_load_wrangle_WQ-and-MET.R'))

# for the map
source(here::here('R', '04_map.R'))

```

# GTM Research Reserve Long-term Stations

```{r map, echo = FALSE}
# I want to make an interactive reserve map here with leaflet
# here's a resource I want to use https://towardsdatascience.com/making-interactive-maps-in-r-with-less-than-15-lines-of-code-bfd81f587e12
# picking different map styles: https://leaflet-extras.github.io/leaflet-providers/preview/

spatial %>%
  leaflet(width = 900) %>%
  addTiles() %>%
  addMarkers(clusterOptions = markerClusterOptions(),
             label = ~htmlEscape(station_code),
             labelOptions = labelOptions(textsize = "15px")) %>%
  addPolygons(data = shape_data, weight = 5, col = 'red')
```

# Environmental

## Rainfall

```{r met-rainfall-stack, echo = FALSE, caption = "Ongoing seasonal totals of precipitation at the Pellicer Creek weather station. Winter includes December, January, and February; Spring includes March, April, and May; Summer includes June, July, and August; and Fall includes September, October, and November."}
MET %>% 
  # mutate(totprcp = totprcp * 0.0393701) %>%
  SWMPrExtension::seasonal_barplot(param = 'totprcp',
                                   season_grps = list(c(12,1,2), c(3,4,5), c(6,7,8), c(9, 10, 11)),
                                   season_names = c('Winter', 'Spring', 'Summer', 'Fall'),
                                   hist_avg = TRUE,
                                   converted = FALSE) + 
  theme(axis.text.x = element_text(angle = 45,
                                   vjust = 0.6),
        axis.text = element_text(color = "black", size = 18),
        axis.title.y = element_text(size = 20))
```

```{r met-rainfall-quarter-stack, echo = FALSE, caption = "Ongoing quarterly totals of precipitation at the Pellicer Creek weather station. Quarter 1 (Q1) includes January-March; Quarter 2 (Q2) includes April-June; Quarter 3 (Q3) includes July-September; Quarter 4 (Q4) includes October-December."}
MET %>% 
  # mutate(totprcp = totprcp * 0.0393701) %>%
  SWMPrExtension::seasonal_barplot(param = 'totprcp',
                                   season_grps = list(c(1,2,3), 
                                                      c(4,5,6), 
                                                      c(7,8,9), 
                                                      c(10, 11, 12)),
                                   season_names = c('Q1', 'Q2', 'Q3', 'Q4'),
                                   hist_avg = TRUE,
                                   converted = F) + 
  theme(axis.text.x = element_text(angle = 45,
                                   vjust = 0.6),
        axis.text = element_text(color = "black", size = 18),
        axis.title.y = element_text(size = 20))
```

```{r met-year-bar, echo = FALSE}
MET %>% 
  filter(datetimestamp > '2022-01-01 00:15') %>%
  mutate(date = as.Date(datetimestamp),
         month = lubridate::month(date, label = T),
         totprcp_in = totprcp * 0.0393701) %>% 
  # group_by(month) %>%
  # summarise(sum = sum(totprcp_in, na.rm = T)) %>%
  # summarise(mean = mean(sum)) %>% 
  ggplot() +
  geom_col(aes(x = month, y = totprcp_in), fill = "#0075AC") +
  geom_hline(yintercept = 3.05, size = 2, linetype = "dashed", color = "grey50") +
  scale_y_continuous(expand = c(0,0)) +
  theme_classic() +
  theme(axis.text = element_text(color = "black", size= 18),
        axis.title.y = element_text(color = "black", size = 20)) +
  labs(x = '',
       y = 'Total Precipitation (in)',
       title = "Current year monthly totals",
       caption = "Hortizontal line represents current year monthly average.")
```

## Temperature {.tabset .tabset-pills}

### Pine Island

```{r pi-temp-annual-boxplot, echo = FALSE}
seasonal_boxplot(pi, param = 'temp') + labs(title = "Pine Island") + theme(legend.position = "none")
```

```{r pi-temp-range, echo = FALSE}
historical_daily_range(pi, param = 'temp', target_yr = 2022)
```

### San Sebastian

```{r ss-temp-annual-boxplot, echo = FALSE}
seasonal_boxplot(ss, param = 'temp') + labs(title = "San Sebastian") + theme(legend.position = "none")
```

```{r ss-temp-range, echo = FALSE}
historical_daily_range(ss, param = 'temp', target_yr = 2022)
```

### Fort Matanzas

```{r fm-temp-annual-boxplot, echo = FALSE}
seasonal_boxplot(fm, param = 'temp') + labs(title = "Fort Matanzas") + theme(legend.position = "none")
```

```{r fm-temp-range, echo = FALSE}
historical_daily_range(fm, param = 'temp', target_yr = 2022)
```

### Pellicer Creek

```{r pc-temp-annual-boxplot, echo = FALSE}
seasonal_boxplot(pc, param = 'temp') + labs(title = "Pellicer Creek") + theme(legend.position = "none")
```

```{r pc-temp-range, echo = FALSE}
historical_daily_range(pc, param = 'temp', target_yr = 2022)
```

## Salinity {.tabset .tabset-pills}

### Pine Island

```{r pi-sal-annual-boxplot, echo = FALSE}
seasonal_boxplot(pi, param = 'sal') + labs(title = "Pine Island") + theme(legend.position = "none")
```

```{r pi-sal-range, echo = FALSE}
historical_daily_range(pi, param = 'sal', target_yr = 2022)
```

### San Sebastian

```{r ss-sal-annual-boxplot, echo = FALSE}
seasonal_boxplot(ss, param = 'sal') + labs(title = "San Sebastian") + theme(legend.position = "none")
```

```{r ss-sal-range, echo = FALSE}
historical_daily_range(ss, param = 'sal', target_yr = 2022)
```

### Fort Matanzas

```{r fm-sal-annual-boxplot, echo = FALSE}
seasonal_boxplot(fm , param = 'sal') + labs(title = "Fort Matanzas") + theme(legend.position = "none") 
```

```{r fm-sal-range, echo = FALSE}
historical_daily_range(fm, param = 'sal', target_yr = 2022)
```

### Pellicer Creek

```{r pc-sal-annual-boxplot, echo = FALSE}
pc %>%
  seasonal_boxplot(param = 'sal') + 
  labs(title = "Pellicer Creek") + theme(legend.position = "none")
```

```{r pc-sal-range, echo = FALSE}
pc %>%
  historical_daily_range(param = 'sal', target_yr = 2022)
```

## Total Suspended Solids and Turbidity

*in development*

# Nutrient Indicators

## Dissolved Oxygen {.tabset .tabset-pills}

### Pine Island

```{r pi-do-annual-boxplot, echo = FALSE}
seasonal_boxplot(pi, param = 'do_mgl') + labs(title = "Pine Island") + theme(legend.position = "none")
```

```{r pi-do-range, echo = FALSE}
pi %>% 
  filter(do_mgl > 0) %>% 
historical_daily_range(param = 'do_mgl', target_yr = 2022, criteria = 2)
```

### San Sebastian

```{r ss-do-annual-boxplot, echo = FALSE}
seasonal_boxplot(ss, param = 'do_mgl') + labs(title = "San Sebastian") + theme(legend.position = "none")
```

```{r ss-do-range, echo = FALSE}
historical_daily_range(ss, param = 'do_mgl', target_yr = 2022, criteria = 2)
```

### Fort Matanzas

```{r fm-do-annual-boxplot, echo = FALSE}
seasonal_boxplot(filter(fm, do_mgl > 0) , param = 'do_mgl') + labs(title = "Fort Matanzas") + theme(legend.position = "none") # fm has some negative do values in 2003 that were not removed during qaqc
```

```{r fm-do-range, echo = FALSE}
historical_daily_range(filter(fm, do_mgl > 0), param = 'do_mgl', target_yr = 2022, criteria = 2)
```

### Pellicer Creek

```{r pc-do-annual-boxplot, echo = FALSE}
pc %>% 
  filter(do_mgl < 20 & do_mgl > 0) %>% 
  seasonal_boxplot(param = 'do_mgl') + 
  labs(title = "Pellicer Creek") + theme(legend.position = "none")
```

```{r pc-do-range, echo = FALSE}
pc %>% 
  filter(do_mgl < 20 & do_mgl > 0) %>% 
  historical_daily_range(param = 'do_mgl', target_yr = 2022, criteria = 2)
```

```{r pc-do-threshold, echo = FALSE}
threshold_criteria_plot(pc, param = 'do_mgl', rng = c(2016, 2022), 
                        thresholds = c(2,5),
                        threshold_labs = c('Poor', 'Fair', 'Good'), 
                        monthly_smooth = TRUE, 
                        threshold_cols = c('#FEC596', '#FFFFCC', '#ABD9E9')) +
  theme(axis.text = element_text(color = "black", size = 18),
        axis.title.y = element_text(size = 20))
```


## Chlorophyll a (ug/L)

### Pine Island {.tabset .tabset-pills}

#### Historic Data with Current Year Overlay

```{r pi-chla-boxplot, echo = FALSE}
ggplotly(boxplot_currentyear(station = "gtmpinut", 
                             param = 0, 
                             threshold = 6.6) +
labs(title = "Pine Island") +
annotate("text",
           x = "Mar",
           y = 16,
           size = 3,
           color = "blue",
           label = "State Threshold 6.6 (\U00B5g/L)")
)
```

#### Annual Geometric Means 2002-2022

*Disclaimer: the 2022 value is based upon data to date and does not equal an entire year of data.*

```{r pi-chla-agm, echo = FALSE}
ggplotly(agm(station = "gtmpinut", 
                             param = 0, 
                             threshold = 6.6) +
labs(title = "Pine Island") +
annotate("text",
           x = "2006",
           y = 8,
           size = 3,
           color = "blue",
           label = "State Threshold 6.6 (\U00B5g/L)")
)
```

### San Sebastian {.tabset .tabset-pills}

#### Historic Data with Current Year Overlay

```{r ss-chla-boxplot, echo = FALSE}
ggplotly(boxplot_currentyear(station = "gtmssnut", 
                             param = 0, 
                             threshold = 4.0) +
labs(title = "San Sebastian") +
  annotate("text",
           x = "Mar",
           y = 16,
           size = 3,
           color = "blue",
           label = "State Threshold 4.0 (\U00B5g/L)")
)
```

#### Annual Geometric Means 2002-2022

*Disclaimer: the 2022 value is based upon data to date and does not equal an entire year of data.*

```{r ss-chla-agm, echo = FALSE}
ggplotly(agm(station = "gtmssnut", 
                             param = 0, 
                             threshold = 4.0) +
labs(title = "San Sebastian") +
annotate("text",
           x = "2006",
           y = 6,
           size = 3,
           color = "blue",
           label = "State Threshold 4.0 (\U00B5g/L)")
)
```

### Fort Matanzas {.tabset .tabset-pills}

#### Historic Data with Current Year Overlay

```{r fm-chla-boxplot, echo = FALSE}
ggplotly(boxplot_currentyear(station = "gtmfmnut", 
                             param = 0, 
                             threshold = 5.5) +
labs(title = "Fort Matanzas") +
  annotate("text",
           x = "Mar",
           y = 24,
           size = 3,
           color = "blue",
           label = "State Threshold 5.5 (\U00B5g/L)")
)
```

#### Annual Geometric Means 2002-2022

*Disclaimer: the 2022 value is based upon data to date and does not equal an entire year of data.*

```{r fm-chla-agm, echo = FALSE}
ggplotly(agm(station = "gtmfmnut", 
                             param = 0, 
                             threshold = 5.5) +
labs(title = "Fort Matanzas") +
annotate("text",
           x = "2006",
           y = 6,
           size = 3,
           color = "blue",
           label = "State Threshold 5.5 (\U00B5g/L)")
)
```

### Pellicer Creek {.tabset .tabset-pills}

#### Historic Data with Current Year Overlay

```{r pc-chla-boxplot, echo = FALSE}
ggplotly(boxplot_currentyear(station = "gtmpcnut", 
                             param = 0, 
                             threshold = 4.3) +
labs(title = "Pellicer Creek") +
  annotate("text",
           x = "Mar",
           y = 38,
           size = 3,
           color = "blue",
           label = "State Threshold 4.3 (\U00B5g/L)")
)
```

#### Annual Geometric Means 2002-2022

*Disclaimer: the 2022 value is based upon data to date and does not equal an entire year of data.*

```{r pc-chla-agm, echo = FALSE}
ggplotly(agm(station = "gtmpcnut", 
                             param = 0, 
                             threshold = 4.3) +
labs(title = "Pellicer Creek") +
annotate("text",
           x = "2006",
           y = 16,
           size = 3,
           color = "blue",
           label = "State Threshold 4.3 (\U00B5g/L)")
)
```

#### Sonde and extracted data

```{r sonde-ext-pc, echo = FALSE} 
chla_dat <- tribble(
  ~MONITORING_PROGRAM, ~type,
  1, "Grab",
  2, "Diel"
)

pc_chla_nut <- NUT %>% 
  filter(STATION_CODE == "gtmpcnut" & DATE_TIME_STAMP > "2019-06-01 00:00") %>% 
  select(DATE_TIME_STAMP, MONITORING_PROGRAM, CHLA_N, F_CHLA_N) %>% 
  filter(!grepl("CUS|-3", F_CHLA_N)) %>% 
  left_join(chla_dat, by = "MONITORING_PROGRAM") %>% 
  select(DATE_TIME_STAMP, CHLA_N, type) %>% 
  rename(datetimestamp = DATE_TIME_STAMP,
         CHLA = CHLA_N)

pc_chla_sonde <- WQ %>% 
  filter(station == "gtmpcwq" & !is.na(chlfluor)) %>% 
  select(datetimestamp, chlfluor) %>% 
  mutate(type = "Sonde") %>% 
  rename(CHLA = chlfluor)

pc_chla <- bind_rows(pc_chla_nut, pc_chla_sonde)
rm(pc_chla_nut, pc_chla_sonde, chla_dat)

dte_formatter <- function(x) { 
  #formatter for axis labels: J12, F12, M12, etc... 
  mth <- substr(format(x, "%b"),1,1) 
  mth 
} 

#First we have to pull out the January dates from the data
pc_chla %>% 
  ggplot() +
  geom_point(data = filter(pc_chla, type == "Sonde"), 
             aes(x = datetimestamp, y = CHLA, color = "Sonde"), 
             shape = 1) +
  geom_point(data = filter(pc_chla, type == "Diel"),
             aes(x = datetimestamp, y = CHLA, color = "Diel"),
             size = 2) +
  geom_point(data = filter(pc_chla, type == "Grab"),
             aes(x = datetimestamp, y = CHLA, color = "Grab"),
             size = 2) +
  scale_colour_manual(name = '', 
                      values = c('Grab'='#0072B2', 
                                 'Diel'='#E69F00', 
                                 'Sonde'='grey70')) +
  geom_vline(xintercept = as.numeric(pc_chla$datetimestamp[yday(pc_chla$datetimestamp) == 1]), 
             colour = "grey60") +
  scale_y_continuous(expand = c(0,0)) +
  scale_x_datetime(date_breaks = "1 months", labels = dte_formatter, expand = c(0,0)) +
  theme_classic() +
  theme(axis.ticks.x = element_line(color = "black"),
        axis.text = element_text(color = "black"),
        axis.title.y = element_text(color = "black"),
        legend.text = element_text(color = "black")) +
  labs(x = "",
       y = "Chlorophyll a (\U00B5g/L)") +
  annotate("text",
           x = as.POSIXct("2019-07-15 00:00"),
           y = 75,
           size = 5,
           color = "black",
           label = "2019") +
  annotate("text",
           x = as.POSIXct("2020-02-15 00:00"),
           y = 75,
           size = 5,
           color = "black",
           label = "2020") +
  annotate("text",
           x = as.POSIXct("2021-02-15 00:00"),
           y = 75,
           size = 5,
           color = "black",
           label = "2021") +
  annotate("text",
           x = as.POSIXct("2022-02-15 00:00"),
           y = 75,
           size = 5,
           color = "black",
           label = "2022")

rm(pc_chla, dte_formatter)

```

## Total Nitrogen (mg/L)

### Pine Island {.tabset .tabset-pills}

#### Historic Data with Current Year Overlay

```{r pi-TN-boxplot, echo = FALSE}
ggplotly(boxplot_currentyear(station = "gtmpinut", 
                             param = 1, 
                             threshold = 0.65) +
labs(title = "Pine Island") +
annotate("text",
           x = "Mar",
           y = 1.2,
           size = 3,
           color = "blue",
           label = "State Threshold 0.65 (mg/L)")
)
```

#### Annual Geometric Means 2002-2022

*Disclaimer: the 2022 value is based upon data to date and does not equal an entire year of data.*

```{r pi-TN-agm, echo = FALSE}
ggplotly(agm(station = "gtmpinut", 
                             param = 1, 
                             threshold = 0.65) +
labs(title = "Pine Island") +
annotate("text",
           x = "2006",
           y = 0.68,
           size = 3,
           color = "blue",
           label = "State Threshold 0.65 (\U00B5g/L)")
)
```

### San Sebastian {.tabset .tabset-pills}

#### Historic Data with Current Year Overlay

```{r ss-TN-boxplot, echo = FALSE}
ggplotly(boxplot_currentyear(station = "gtmssnut", 
                             param = 1, 
                             threshold = 0.55) +
  labs(title = "San Sebastian") +
  annotate("text",
           x = "Mar",
           y = 1.0,
           size = 3,
           color = "blue",
           label = "State Threshold 0.55 (mg/L)")
)
```

#### Annual Geometric Means 2002-2022

*Disclaimer: the 2022 value is based upon data to date and does not equal an entire year of data.*

```{r ss-TN-agm, echo = FALSE}
ggplotly(agm(station = "gtmssnut", 
                             param = 1, 
                             threshold = 0.55) +
labs(title = "San Sebastian") +
annotate("text",
           x = "2006",
           y = 0.58,
           size = 3,
           color = "blue",
           label = "State Threshold 0.55 (\U00B5g/L)")
)
```

### Fort Matanzas {.tabset .tabset-pills}

#### Historic Data with Current Year Overlay

```{r fm-TN-boxplot, echo = FALSE}
ggplotly(boxplot_currentyear(station = "gtmfmnut", 
                             param = 1, 
                             threshold = 0.55) +
  labs(title = "Fort Matanzas") +
  annotate("text",
           x = "Mar",
           y = 1.0,
           size = 3,
           color = "blue",
           label = "State Threshold 0.55 (mg/L)")
)
```

#### Annual Geometric Means 2002-2022

*Disclaimer: the 2022 value is based upon data to date and does not equal an entire year of data.*

```{r fm-TN-agm, echo = FALSE}
ggplotly(agm(station = "gtmfmnut", 
                             param = 1, 
                             threshold = 0.53) +
labs(title = "Fort Matanzas") +
annotate("text",
           x = "2006",
           y = 0.55,
           size = 3,
           color = "blue",
           label = "State Threshold 0.53 (\U00B5g/L)")
)
```

### Pellicer Creek {.tabset .tabset-pills}

#### Historic Data with Current Year Overlay

```{r pc-TN-boxplot, echo = FALSE}
ggplotly(boxplot_currentyear(station = "gtmpcnut", 
                             param = 1, 
                             threshold = 1.10) +
labs(title = "Pellicer Creek") +
  annotate("text",
           x = "Mar",
           y = 1.7,
           size = 3,
           color = "blue",
           label = "State Threshold 1.10 (mg/L)")
)
```

#### Annual Geometric Means 2002-2022

*Disclaimer: the 2022 value is based upon data to date and does not equal an entire year of data.*

```{r pc-TN-agm, echo = FALSE}
ggplotly(agm(station = "gtmpcnut", 
                             param = 1, 
                             threshold = 1.10) +
labs(title = "Pellicer Creek") +
annotate("text",
           x = "2006",
           y = 1.15,
           size = 3,
           color = "blue",
           label = "State Threshold 1.1 (\U00B5g/L)")
)
```

## Total Phosphorus (mg/L)

### Pine Island {.tabset .tabset-pills}

#### Historic Data with Current Year Overlay

```{r pi-TP-boxplot, echo = FALSE}
ggplotly(boxplot_currentyear(station = "gtmpinut", 
                             param = 2, 
                             threshold = 0.105) +
 labs(title = "Pine Island") +
  annotate("text",
           x = "Mar",
           y = 0.15,
           size = 3,
           color = "blue",
           label = "State Threshold 0.105 (mg/L)")
)
```

#### Annual Geometric Means 2002-2022

*Disclaimer: the 2022 value is based upon data to date and does not equal an entire year of data.*

```{r pi-tp-agm, echo = FALSE}
ggplotly(agm(station = "gtmpinut", 
    param = 2, 
    threshold = 0.105) +
  labs(title = "Pine Island") +
  annotate("text",
           x = "2006",
           y = 0.15,
           size = 3,
           color = "blue",
           label = "State Threshold 0.105 (\U00B5g/L)")
)
```

### San Sebastian {.tabset .tabset-pills}

#### Historic Data with Current Year Overlay

```{r ss-TP-boxplot, echo = FALSE}
ggplotly(boxplot_currentyear(station = "gtmssnut", 
                             param = 2, 
                             threshold = 0.11) +
  labs(title = "San Sebastian") +
  annotate("text",
           x = "Mar",
           y = 0.12,
           size = 3,
           color = "blue",
           label = "State Threshold 0.11 (mg/L)")
)
```

#### Annual Geometric Means 2002-2022

*Disclaimer: the 2022 value is based upon data to date and does not equal an entire year of data.*

```{r ss-tp-agm, echo = FALSE}
ggplotly(agm(station = "gtmssnut", 
    param = 2, 
    threshold = 0.11) +
  labs(title = "San Sebastian") +
  annotate("text",
           x = "2006",
           y = 0.12,
           size = 3,
           color = "blue",
           label = "State Threshold 0.11 (\U00B5g/L)")
)
```

### Fort Matanzas {.tabset .tabset-pills}

#### Historic Data with Current Year Overlay

```{r fm-TP-boxplot, echo = FALSE}
ggplotly(boxplot_currentyear(station = "gtmfmnut", 
                             param = 2, 
                             threshold = 0.111) +
labs(title = "Fort Matanzas") +
  annotate("text",
           x = "Mar",
           y = 0.12,
           size = 3,
           color = "blue",
           label = "State Threshold 0.111 (mg/L)")
)
```

#### Annual Geometric Means 2002-2022

*Disclaimer: the 2022 value is based upon data to date and does not equal an entire year of data.*

```{r fm-tp-agm, echo = FALSE}
ggplotly(agm(station = "gtmfmnut", 
    param = 2, 
    threshold = 0.111) +
  labs(title = "Fort Matanzas") +
  annotate("text",
           x = "2006",
           y = 0.12,
           size = 3,
           color = "blue",
           label = "State Threshold 0.111 (\U00B5g/L)")
)
```

### Pellicer Creek {.tabset .tabset-pills}

#### Historic Data with Current Year Overlay

```{r pc-TP-boxplot, echo = FALSE}
ggplotly(boxplot_currentyear(station = "gtmpcnut", 
                             param = 2, 
                             threshold = 0.123) +
labs(title = "Pellicer Creek") +
  annotate("text",
           x = "Mar",
           y = 0.25,
           size = 3,
           color = "blue",
           label = "State Threshold 0.123 (mg/L)")
)
```

#### Annual Geometric Means 2002-2022

*Disclaimer: the 2022 value is based upon data to date and does not equal an entire year of data.*

```{r pc-tp-agm, echo = FALSE}
ggplotly(agm(station = "gtmpcnut", 
    param = 2, 
    threshold = 0.123) +
  labs(title = "Pellicer Creek") +
  annotate("text",
           x = "2006",
           y = 0.25,
           size = 3,
           color = "blue",
           label = "State Threshold 0.123 (\U00B5g/L)")
)
```
